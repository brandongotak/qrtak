(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function c(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(t){if(t.ep)return;t.ep=!0;const n=c(t);fetch(t.href,n)}})();function pe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var V={},ot,Nt;function Ee(){return Nt||(Nt=1,ot=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),ot}var rt={},F={},Mt;function $(){if(Mt)return F;Mt=1;let e;const r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return F.getSymbolSize=function(o){if(!o)throw new Error('"version" cannot be null or undefined');if(o<1||o>40)throw new Error('"version" should be in range from 1 to 40');return o*4+17},F.getSymbolTotalCodewords=function(o){return r[o]},F.getBCHDigit=function(c){let o=0;for(;c!==0;)o++,c>>>=1;return o},F.setToSJISFunction=function(o){if(typeof o!="function")throw new Error('"toSJISFunc" is not a valid function.');e=o},F.isKanjiModeEnabled=function(){return typeof e<"u"},F.toSJIS=function(o){return e(o)},F}var it={},Ot;function St(){return Ot||(Ot=1,function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function r(c){if(typeof c!="string")throw new Error("Param is not a string");switch(c.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+c)}}e.isValid=function(o){return o&&typeof o.bit<"u"&&o.bit>=0&&o.bit<4},e.from=function(o,t){if(e.isValid(o))return o;try{return r(o)}catch{return t}}}(it)),it}var at,Dt;function ye(){if(Dt)return at;Dt=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(r){const c=Math.floor(r/8);return(this.buffer[c]>>>7-r%8&1)===1},put:function(r,c){for(let o=0;o<c;o++)this.putBit((r>>>c-o-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){const c=Math.floor(this.length/8);this.buffer.length<=c&&this.buffer.push(0),r&&(this.buffer[c]|=128>>>this.length%8),this.length++}},at=e,at}var st,_t;function Ae(){if(_t)return st;_t=1;function e(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}return e.prototype.set=function(r,c,o,t){const n=r*this.size+c;this.data[n]=o,t&&(this.reservedBit[n]=!0)},e.prototype.get=function(r,c){return this.data[r*this.size+c]},e.prototype.xor=function(r,c,o){this.data[r*this.size+c]^=o},e.prototype.isReserved=function(r,c){return this.reservedBit[r*this.size+c]},st=e,st}var ct={},Ut;function Te(){return Ut||(Ut=1,function(e){const r=$().getSymbolSize;e.getRowColCoords=function(o){if(o===1)return[];const t=Math.floor(o/7)+2,n=r(o),a=n===145?26:Math.ceil((n-13)/(2*t-2))*2,i=[n-7];for(let s=1;s<t-1;s++)i[s]=i[s-1]-a;return i.push(6),i.reverse()},e.getPositions=function(o){const t=[],n=e.getRowColCoords(o),a=n.length;for(let i=0;i<a;i++)for(let s=0;s<a;s++)i===0&&s===0||i===0&&s===a-1||i===a-1&&s===0||t.push([n[i],n[s]]);return t}}(ct)),ct}var ut={},qt;function we(){if(qt)return ut;qt=1;const e=$().getSymbolSize,r=7;return ut.getPositions=function(o){const t=e(o);return[[0,0],[t-r,0],[0,t-r]]},ut}var lt={},Kt;function Ie(){return Kt||(Kt=1,function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const r={N1:3,N2:3,N3:40,N4:10};e.isValid=function(t){return t!=null&&t!==""&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){const n=t.size;let a=0,i=0,s=0,u=null,d=null;for(let m=0;m<n;m++){i=s=0,u=d=null;for(let l=0;l<n;l++){let f=t.get(m,l);f===u?i++:(i>=5&&(a+=r.N1+(i-5)),u=f,i=1),f=t.get(l,m),f===d?s++:(s>=5&&(a+=r.N1+(s-5)),d=f,s=1)}i>=5&&(a+=r.N1+(i-5)),s>=5&&(a+=r.N1+(s-5))}return a},e.getPenaltyN2=function(t){const n=t.size;let a=0;for(let i=0;i<n-1;i++)for(let s=0;s<n-1;s++){const u=t.get(i,s)+t.get(i,s+1)+t.get(i+1,s)+t.get(i+1,s+1);(u===4||u===0)&&a++}return a*r.N2},e.getPenaltyN3=function(t){const n=t.size;let a=0,i=0,s=0;for(let u=0;u<n;u++){i=s=0;for(let d=0;d<n;d++)i=i<<1&2047|t.get(u,d),d>=10&&(i===1488||i===93)&&a++,s=s<<1&2047|t.get(d,u),d>=10&&(s===1488||s===93)&&a++}return a*r.N3},e.getPenaltyN4=function(t){let n=0;const a=t.data.length;for(let s=0;s<a;s++)n+=t.data[s];return Math.abs(Math.ceil(n*100/a/5)-10)*r.N4};function c(o,t,n){switch(o){case e.Patterns.PATTERN000:return(t+n)%2===0;case e.Patterns.PATTERN001:return t%2===0;case e.Patterns.PATTERN010:return n%3===0;case e.Patterns.PATTERN011:return(t+n)%3===0;case e.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2===0;case e.Patterns.PATTERN101:return t*n%2+t*n%3===0;case e.Patterns.PATTERN110:return(t*n%2+t*n%3)%2===0;case e.Patterns.PATTERN111:return(t*n%3+(t+n)%2)%2===0;default:throw new Error("bad maskPattern:"+o)}}e.applyMask=function(t,n){const a=n.size;for(let i=0;i<a;i++)for(let s=0;s<a;s++)n.isReserved(s,i)||n.xor(s,i,c(t,s,i))},e.getBestMask=function(t,n){const a=Object.keys(e.Patterns).length;let i=0,s=1/0;for(let u=0;u<a;u++){n(u),e.applyMask(u,t);const d=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(u,t),d<s&&(s=d,i=u)}return i}}(lt)),lt}var W={},Ft;function ce(){if(Ft)return W;Ft=1;const e=St(),r=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],c=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return W.getBlocksCount=function(t,n){switch(n){case e.L:return r[(t-1)*4+0];case e.M:return r[(t-1)*4+1];case e.Q:return r[(t-1)*4+2];case e.H:return r[(t-1)*4+3];default:return}},W.getTotalCodewordsCount=function(t,n){switch(n){case e.L:return c[(t-1)*4+0];case e.M:return c[(t-1)*4+1];case e.Q:return c[(t-1)*4+2];case e.H:return c[(t-1)*4+3];default:return}},W}var dt={},Y={},Ht;function Be(){if(Ht)return Y;Ht=1;const e=new Uint8Array(512),r=new Uint8Array(256);return function(){let o=1;for(let t=0;t<255;t++)e[t]=o,r[o]=t,o<<=1,o&256&&(o^=285);for(let t=255;t<512;t++)e[t]=e[t-255]}(),Y.log=function(o){if(o<1)throw new Error("log("+o+")");return r[o]},Y.exp=function(o){return e[o]},Y.mul=function(o,t){return o===0||t===0?0:e[r[o]+r[t]]},Y}var $t;function Re(){return $t||($t=1,function(e){const r=Be();e.mul=function(o,t){const n=new Uint8Array(o.length+t.length-1);for(let a=0;a<o.length;a++)for(let i=0;i<t.length;i++)n[a+i]^=r.mul(o[a],t[i]);return n},e.mod=function(o,t){let n=new Uint8Array(o);for(;n.length-t.length>=0;){const a=n[0];for(let s=0;s<t.length;s++)n[s]^=r.mul(t[s],a);let i=0;for(;i<n.length&&n[i]===0;)i++;n=n.slice(i)}return n},e.generateECPolynomial=function(o){let t=new Uint8Array([1]);for(let n=0;n<o;n++)t=e.mul(t,new Uint8Array([1,r.exp(n)]));return t}}(dt)),dt}var ft,zt;function ve(){if(zt)return ft;zt=1;const e=Re();function r(c){this.genPoly=void 0,this.degree=c,this.degree&&this.initialize(this.degree)}return r.prototype.initialize=function(o){this.degree=o,this.genPoly=e.generateECPolynomial(this.degree)},r.prototype.encode=function(o){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(o.length+this.degree);t.set(o);const n=e.mod(t,this.genPoly),a=this.degree-n.length;if(a>0){const i=new Uint8Array(this.degree);return i.set(n,a),i}return n},ft=r,ft}var mt={},gt={},ht={},Qt;function ue(){return Qt||(Qt=1,ht.isValid=function(r){return!isNaN(r)&&r>=1&&r<=40}),ht}var D={},Vt;function le(){if(Vt)return D;Vt=1;const e="[0-9]+",r="[A-Z $%*+\\-./:]+";let c="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";c=c.replace(/u/g,"\\u");const o="(?:(?![A-Z0-9 $%*+\\-./:]|"+c+`)(?:.|[\r
]))+`;D.KANJI=new RegExp(c,"g"),D.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),D.BYTE=new RegExp(o,"g"),D.NUMERIC=new RegExp(e,"g"),D.ALPHANUMERIC=new RegExp(r,"g");const t=new RegExp("^"+c+"$"),n=new RegExp("^"+e+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return D.testKanji=function(s){return t.test(s)},D.testNumeric=function(s){return n.test(s)},D.testAlphanumeric=function(s){return a.test(s)},D}var jt;function z(){return jt||(jt=1,function(e){const r=ue(),c=le();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(n,a){if(!n.ccBits)throw new Error("Invalid mode: "+n);if(!r.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?n.ccBits[0]:a<27?n.ccBits[1]:n.ccBits[2]},e.getBestModeForData=function(n){return c.testNumeric(n)?e.NUMERIC:c.testAlphanumeric(n)?e.ALPHANUMERIC:c.testKanji(n)?e.KANJI:e.BYTE},e.toString=function(n){if(n&&n.id)return n.id;throw new Error("Invalid mode")},e.isValid=function(n){return n&&n.bit&&n.ccBits};function o(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}e.from=function(n,a){if(e.isValid(n))return n;try{return o(n)}catch{return a}}}(gt)),gt}var Yt;function Ce(){return Yt||(Yt=1,function(e){const r=$(),c=ce(),o=St(),t=z(),n=ue(),a=7973,i=r.getBCHDigit(a);function s(l,f,g){for(let h=1;h<=40;h++)if(f<=e.getCapacity(h,g,l))return h}function u(l,f){return t.getCharCountIndicator(l,f)+4}function d(l,f){let g=0;return l.forEach(function(h){const b=u(h.mode,f);g+=b+h.getBitsLength()}),g}function m(l,f){for(let g=1;g<=40;g++)if(d(l,g)<=e.getCapacity(g,f,t.MIXED))return g}e.from=function(f,g){return n.isValid(f)?parseInt(f,10):g},e.getCapacity=function(f,g,h){if(!n.isValid(f))throw new Error("Invalid QR Code version");typeof h>"u"&&(h=t.BYTE);const b=r.getSymbolTotalCodewords(f),A=c.getTotalCodewordsCount(f,g),y=(b-A)*8;if(h===t.MIXED)return y;const w=y-u(h,f);switch(h){case t.NUMERIC:return Math.floor(w/10*3);case t.ALPHANUMERIC:return Math.floor(w/11*2);case t.KANJI:return Math.floor(w/13);case t.BYTE:default:return Math.floor(w/8)}},e.getBestVersionForData=function(f,g){let h;const b=o.from(g,o.M);if(Array.isArray(f)){if(f.length>1)return m(f,b);if(f.length===0)return 1;h=f[0]}else h=f;return s(h.mode,h.getLength(),b)},e.getEncodedBits=function(f){if(!n.isValid(f)||f<7)throw new Error("Invalid QR Code version");let g=f<<12;for(;r.getBCHDigit(g)-i>=0;)g^=a<<r.getBCHDigit(g)-i;return f<<12|g}}(mt)),mt}var pt={},Jt;function Se(){if(Jt)return pt;Jt=1;const e=$(),r=1335,c=21522,o=e.getBCHDigit(r);return pt.getEncodedBits=function(n,a){const i=n.bit<<3|a;let s=i<<10;for(;e.getBCHDigit(s)-o>=0;)s^=r<<e.getBCHDigit(s)-o;return(i<<10|s)^c},pt}var Et={},yt,Gt;function ke(){if(Gt)return yt;Gt=1;const e=z();function r(c){this.mode=e.NUMERIC,this.data=c.toString()}return r.getBitsLength=function(o){return 10*Math.floor(o/3)+(o%3?o%3*3+1:0)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(o){let t,n,a;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),a=parseInt(n,10),o.put(a,10);const i=this.data.length-t;i>0&&(n=this.data.substr(t),a=parseInt(n,10),o.put(a,i*3+1))},yt=r,yt}var At,Zt;function Pe(){if(Zt)return At;Zt=1;const e=z(),r=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function c(o){this.mode=e.ALPHANUMERIC,this.data=o}return c.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)},c.prototype.getLength=function(){return this.data.length},c.prototype.getBitsLength=function(){return c.getBitsLength(this.data.length)},c.prototype.write=function(t){let n;for(n=0;n+2<=this.data.length;n+=2){let a=r.indexOf(this.data[n])*45;a+=r.indexOf(this.data[n+1]),t.put(a,11)}this.data.length%2&&t.put(r.indexOf(this.data[n]),6)},At=c,At}var Tt,Wt;function be(){if(Wt)return Tt;Wt=1;const e=z();function r(c){this.mode=e.BYTE,typeof c=="string"?this.data=new TextEncoder().encode(c):this.data=new Uint8Array(c)}return r.getBitsLength=function(o){return o*8},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(c){for(let o=0,t=this.data.length;o<t;o++)c.put(this.data[o],8)},Tt=r,Tt}var wt,Xt;function Le(){if(Xt)return wt;Xt=1;const e=z(),r=$();function c(o){this.mode=e.KANJI,this.data=o}return c.getBitsLength=function(t){return t*13},c.prototype.getLength=function(){return this.data.length},c.prototype.getBitsLength=function(){return c.getBitsLength(this.data.length)},c.prototype.write=function(o){let t;for(t=0;t<this.data.length;t++){let n=r.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);n=(n>>>8&255)*192+(n&255),o.put(n,13)}},wt=c,wt}var It={exports:{}},xt;function Ne(){return xt||(xt=1,function(e){var r={single_source_shortest_paths:function(c,o,t){var n={},a={};a[o]=0;var i=r.PriorityQueue.make();i.push(o,0);for(var s,u,d,m,l,f,g,h,b;!i.empty();){s=i.pop(),u=s.value,m=s.cost,l=c[u]||{};for(d in l)l.hasOwnProperty(d)&&(f=l[d],g=m+f,h=a[d],b=typeof a[d]>"u",(b||h>g)&&(a[d]=g,i.push(d,g),n[d]=u))}if(typeof t<"u"&&typeof a[t]>"u"){var A=["Could not find a path from ",o," to ",t,"."].join("");throw new Error(A)}return n},extract_shortest_path_from_predecessor_list:function(c,o){for(var t=[],n=o;n;)t.push(n),c[n],n=c[n];return t.reverse(),t},find_path:function(c,o,t){var n=r.single_source_shortest_paths(c,o,t);return r.extract_shortest_path_from_predecessor_list(n,t)},PriorityQueue:{make:function(c){var o=r.PriorityQueue,t={},n;c=c||{};for(n in o)o.hasOwnProperty(n)&&(t[n]=o[n]);return t.queue=[],t.sorter=c.sorter||o.default_sorter,t},default_sorter:function(c,o){return c.cost-o.cost},push:function(c,o){var t={value:c,cost:o};this.queue.push(t),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=r}(It)),It.exports}var te;function Me(){return te||(te=1,function(e){const r=z(),c=ke(),o=Pe(),t=be(),n=Le(),a=le(),i=$(),s=Ne();function u(A){return unescape(encodeURIComponent(A)).length}function d(A,y,w){const T=[];let N;for(;(N=A.exec(w))!==null;)T.push({data:N[0],index:N.index,mode:y,length:N[0].length});return T}function m(A){const y=d(a.NUMERIC,r.NUMERIC,A),w=d(a.ALPHANUMERIC,r.ALPHANUMERIC,A);let T,N;return i.isKanjiModeEnabled()?(T=d(a.BYTE,r.BYTE,A),N=d(a.KANJI,r.KANJI,A)):(T=d(a.BYTE_KANJI,r.BYTE,A),N=[]),y.concat(w,T,N).sort(function(v,R){return v.index-R.index}).map(function(v){return{data:v.data,mode:v.mode,length:v.length}})}function l(A,y){switch(y){case r.NUMERIC:return c.getBitsLength(A);case r.ALPHANUMERIC:return o.getBitsLength(A);case r.KANJI:return n.getBitsLength(A);case r.BYTE:return t.getBitsLength(A)}}function f(A){return A.reduce(function(y,w){const T=y.length-1>=0?y[y.length-1]:null;return T&&T.mode===w.mode?(y[y.length-1].data+=w.data,y):(y.push(w),y)},[])}function g(A){const y=[];for(let w=0;w<A.length;w++){const T=A[w];switch(T.mode){case r.NUMERIC:y.push([T,{data:T.data,mode:r.ALPHANUMERIC,length:T.length},{data:T.data,mode:r.BYTE,length:T.length}]);break;case r.ALPHANUMERIC:y.push([T,{data:T.data,mode:r.BYTE,length:T.length}]);break;case r.KANJI:y.push([T,{data:T.data,mode:r.BYTE,length:u(T.data)}]);break;case r.BYTE:y.push([{data:T.data,mode:r.BYTE,length:u(T.data)}])}}return y}function h(A,y){const w={},T={start:{}};let N=["start"];for(let E=0;E<A.length;E++){const v=A[E],R=[];for(let p=0;p<v.length;p++){const S=v[p],I=""+E+p;R.push(I),w[I]={node:S,lastCount:0},T[I]={};for(let C=0;C<N.length;C++){const B=N[C];w[B]&&w[B].node.mode===S.mode?(T[B][I]=l(w[B].lastCount+S.length,S.mode)-l(w[B].lastCount,S.mode),w[B].lastCount+=S.length):(w[B]&&(w[B].lastCount=S.length),T[B][I]=l(S.length,S.mode)+4+r.getCharCountIndicator(S.mode,y))}}N=R}for(let E=0;E<N.length;E++)T[N[E]].end=0;return{map:T,table:w}}function b(A,y){let w;const T=r.getBestModeForData(A);if(w=r.from(y,T),w!==r.BYTE&&w.bit<T.bit)throw new Error('"'+A+'" cannot be encoded with mode '+r.toString(w)+`.
 Suggested mode is: `+r.toString(T));switch(w===r.KANJI&&!i.isKanjiModeEnabled()&&(w=r.BYTE),w){case r.NUMERIC:return new c(A);case r.ALPHANUMERIC:return new o(A);case r.KANJI:return new n(A);case r.BYTE:return new t(A)}}e.fromArray=function(y){return y.reduce(function(w,T){return typeof T=="string"?w.push(b(T,null)):T.data&&w.push(b(T.data,T.mode)),w},[])},e.fromString=function(y,w){const T=m(y,i.isKanjiModeEnabled()),N=g(T),E=h(N,w),v=s.find_path(E.map,"start","end"),R=[];for(let p=1;p<v.length-1;p++)R.push(E.table[v[p]].node);return e.fromArray(f(R))},e.rawSplit=function(y){return e.fromArray(m(y,i.isKanjiModeEnabled()))}}(Et)),Et}var ee;function Oe(){if(ee)return rt;ee=1;const e=$(),r=St(),c=ye(),o=Ae(),t=Te(),n=we(),a=Ie(),i=ce(),s=ve(),u=Ce(),d=Se(),m=z(),l=Me();function f(E,v){const R=E.size,p=n.getPositions(v);for(let S=0;S<p.length;S++){const I=p[S][0],C=p[S][1];for(let B=-1;B<=7;B++)if(!(I+B<=-1||R<=I+B))for(let P=-1;P<=7;P++)C+P<=-1||R<=C+P||(B>=0&&B<=6&&(P===0||P===6)||P>=0&&P<=6&&(B===0||B===6)||B>=2&&B<=4&&P>=2&&P<=4?E.set(I+B,C+P,!0,!0):E.set(I+B,C+P,!1,!0))}}function g(E){const v=E.size;for(let R=8;R<v-8;R++){const p=R%2===0;E.set(R,6,p,!0),E.set(6,R,p,!0)}}function h(E,v){const R=t.getPositions(v);for(let p=0;p<R.length;p++){const S=R[p][0],I=R[p][1];for(let C=-2;C<=2;C++)for(let B=-2;B<=2;B++)C===-2||C===2||B===-2||B===2||C===0&&B===0?E.set(S+C,I+B,!0,!0):E.set(S+C,I+B,!1,!0)}}function b(E,v){const R=E.size,p=u.getEncodedBits(v);let S,I,C;for(let B=0;B<18;B++)S=Math.floor(B/3),I=B%3+R-8-3,C=(p>>B&1)===1,E.set(S,I,C,!0),E.set(I,S,C,!0)}function A(E,v,R){const p=E.size,S=d.getEncodedBits(v,R);let I,C;for(I=0;I<15;I++)C=(S>>I&1)===1,I<6?E.set(I,8,C,!0):I<8?E.set(I+1,8,C,!0):E.set(p-15+I,8,C,!0),I<8?E.set(8,p-I-1,C,!0):I<9?E.set(8,15-I-1+1,C,!0):E.set(8,15-I-1,C,!0);E.set(p-8,8,1,!0)}function y(E,v){const R=E.size;let p=-1,S=R-1,I=7,C=0;for(let B=R-1;B>0;B-=2)for(B===6&&B--;;){for(let P=0;P<2;P++)if(!E.isReserved(S,B-P)){let K=!1;C<v.length&&(K=(v[C]>>>I&1)===1),E.set(S,B-P,K),I--,I===-1&&(C++,I=7)}if(S+=p,S<0||R<=S){S-=p,p=-p;break}}}function w(E,v,R){const p=new c;R.forEach(function(P){p.put(P.mode.bit,4),p.put(P.getLength(),m.getCharCountIndicator(P.mode,E)),P.write(p)});const S=e.getSymbolTotalCodewords(E),I=i.getTotalCodewordsCount(E,v),C=(S-I)*8;for(p.getLengthInBits()+4<=C&&p.put(0,4);p.getLengthInBits()%8!==0;)p.putBit(0);const B=(C-p.getLengthInBits())/8;for(let P=0;P<B;P++)p.put(P%2?17:236,8);return T(p,E,v)}function T(E,v,R){const p=e.getSymbolTotalCodewords(v),S=i.getTotalCodewordsCount(v,R),I=p-S,C=i.getBlocksCount(v,R),B=p%C,P=C-B,K=Math.floor(p/C),j=Math.floor(I/C),me=j+1,Pt=K-j,ge=new s(Pt);let x=0;const Z=new Array(C),bt=new Array(C);let tt=0;const he=new Uint8Array(E.buffer);for(let Q=0;Q<C;Q++){const nt=Q<P?j:me;Z[Q]=he.slice(x,x+nt),bt[Q]=ge.encode(Z[Q]),x+=nt,tt=Math.max(tt,nt)}const et=new Uint8Array(p);let Lt=0,_,U;for(_=0;_<tt;_++)for(U=0;U<C;U++)_<Z[U].length&&(et[Lt++]=Z[U][_]);for(_=0;_<Pt;_++)for(U=0;U<C;U++)et[Lt++]=bt[U][_];return et}function N(E,v,R,p){let S;if(Array.isArray(E))S=l.fromArray(E);else if(typeof E=="string"){let K=v;if(!K){const j=l.rawSplit(E);K=u.getBestVersionForData(j,R)}S=l.fromString(E,K||40)}else throw new Error("Invalid data");const I=u.getBestVersionForData(S,R);if(!I)throw new Error("The amount of data is too big to be stored in a QR Code");if(!v)v=I;else if(v<I)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+I+`.
`);const C=w(v,R,S),B=e.getSymbolSize(v),P=new o(B);return f(P,v),g(P),h(P,v),A(P,R,0),v>=7&&b(P,v),y(P,C),isNaN(p)&&(p=a.getBestMask(P,A.bind(null,P,R))),a.applyMask(p,P),A(P,R,p),{modules:P,version:v,errorCorrectionLevel:R,maskPattern:p,segments:S}}return rt.create=function(v,R){if(typeof v>"u"||v==="")throw new Error("No input text");let p=r.M,S,I;return typeof R<"u"&&(p=r.from(R.errorCorrectionLevel,r.M),S=u.from(R.version),I=a.from(R.maskPattern),R.toSJISFunc&&e.setToSJISFunction(R.toSJISFunc)),N(v,S,p,I)},rt}var Bt={},Rt={},ne;function de(){return ne||(ne=1,function(e){function r(c){if(typeof c=="number"&&(c=c.toString()),typeof c!="string")throw new Error("Color should be defined as hex string");let o=c.slice().replace("#","").split("");if(o.length<3||o.length===5||o.length>8)throw new Error("Invalid hex color: "+c);(o.length===3||o.length===4)&&(o=Array.prototype.concat.apply([],o.map(function(n){return[n,n]}))),o.length===6&&o.push("F","F");const t=parseInt(o.join(""),16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:t&255,hex:"#"+o.slice(0,6).join("")}}e.getOptions=function(o){o||(o={}),o.color||(o.color={});const t=typeof o.margin>"u"||o.margin===null||o.margin<0?4:o.margin,n=o.width&&o.width>=21?o.width:void 0,a=o.scale||4;return{width:n,scale:n?4:a,margin:t,color:{dark:r(o.color.dark||"#000000ff"),light:r(o.color.light||"#ffffffff")},type:o.type,rendererOpts:o.rendererOpts||{}}},e.getScale=function(o,t){return t.width&&t.width>=o+t.margin*2?t.width/(o+t.margin*2):t.scale},e.getImageWidth=function(o,t){const n=e.getScale(o,t);return Math.floor((o+t.margin*2)*n)},e.qrToImageData=function(o,t,n){const a=t.modules.size,i=t.modules.data,s=e.getScale(a,n),u=Math.floor((a+n.margin*2)*s),d=n.margin*s,m=[n.color.light,n.color.dark];for(let l=0;l<u;l++)for(let f=0;f<u;f++){let g=(l*u+f)*4,h=n.color.light;if(l>=d&&f>=d&&l<u-d&&f<u-d){const b=Math.floor((l-d)/s),A=Math.floor((f-d)/s);h=m[i[b*a+A]?1:0]}o[g++]=h.r,o[g++]=h.g,o[g++]=h.b,o[g]=h.a}}}(Rt)),Rt}var oe;function De(){return oe||(oe=1,function(e){const r=de();function c(t,n,a){t.clearRect(0,0,n.width,n.height),n.style||(n.style={}),n.height=a,n.width=a,n.style.height=a+"px",n.style.width=a+"px"}function o(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(n,a,i){let s=i,u=a;typeof s>"u"&&(!a||!a.getContext)&&(s=a,a=void 0),a||(u=o()),s=r.getOptions(s);const d=r.getImageWidth(n.modules.size,s),m=u.getContext("2d"),l=m.createImageData(d,d);return r.qrToImageData(l.data,n,s),c(m,u,d),m.putImageData(l,0,0),u},e.renderToDataURL=function(n,a,i){let s=i;typeof s>"u"&&(!a||!a.getContext)&&(s=a,a=void 0),s||(s={});const u=e.render(n,a,s),d=s.type||"image/png",m=s.rendererOpts||{};return u.toDataURL(d,m.quality)}}(Bt)),Bt}var vt={},re;function _e(){if(re)return vt;re=1;const e=de();function r(t,n){const a=t.a/255,i=n+'="'+t.hex+'"';return a<1?i+" "+n+'-opacity="'+a.toFixed(2).slice(1)+'"':i}function c(t,n,a){let i=t+n;return typeof a<"u"&&(i+=" "+a),i}function o(t,n,a){let i="",s=0,u=!1,d=0;for(let m=0;m<t.length;m++){const l=Math.floor(m%n),f=Math.floor(m/n);!l&&!u&&(u=!0),t[m]?(d++,m>0&&l>0&&t[m-1]||(i+=u?c("M",l+a,.5+f+a):c("m",s,0),s=0,u=!1),l+1<n&&t[m+1]||(i+=c("h",d),d=0)):s++}return i}return vt.render=function(n,a,i){const s=e.getOptions(a),u=n.modules.size,d=n.modules.data,m=u+s.margin*2,l=s.color.light.a?"<path "+r(s.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",f="<path "+r(s.color.dark,"stroke")+' d="'+o(d,u,s.margin)+'"/>',g='viewBox="0 0 '+m+" "+m+'"',b='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+g+' shape-rendering="crispEdges">'+l+f+`</svg>
`;return typeof i=="function"&&i(null,b),b},vt}var ie;function Ue(){if(ie)return V;ie=1;const e=Ee(),r=Oe(),c=De(),o=_e();function t(n,a,i,s,u){const d=[].slice.call(arguments,1),m=d.length,l=typeof d[m-1]=="function";if(!l&&!e())throw new Error("Callback required as last argument");if(l){if(m<2)throw new Error("Too few arguments provided");m===2?(u=i,i=a,a=s=void 0):m===3&&(a.getContext&&typeof u>"u"?(u=s,s=void 0):(u=s,s=i,i=a,a=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(i=a,a=s=void 0):m===2&&!a.getContext&&(s=i,i=a,a=void 0),new Promise(function(f,g){try{const h=r.create(i,s);f(n(h,a,s))}catch(h){g(h)}})}try{const f=r.create(i,s);u(null,n(f,a,s))}catch(f){u(f)}}return V.create=r.create,V.toCanvas=t.bind(null,c.render),V.toDataURL=t.bind(null,c.renderToDataURL),V.toString=t.bind(null,function(n,a,i){return o.render(n,i)}),V}var qe=Ue();const Ke=pe(qe),fe={HOSTNAME:/^[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,60}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,60}[a-zA-Z0-9])?)*$/,PORT:/^([1-9][0-9]{0,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$/};function Ct(e,r){let c;return function(...t){const n=()=>{clearTimeout(c),e.apply(this,t)};clearTimeout(c),c=setTimeout(n,r)}}function H(e){const r=document.createElement("div");return r.textContent=e,r.innerHTML}function X(e){if(!e||typeof e!="string")return"";try{const r=e.trim(),c=r.startsWith("http")?r:`https://${r}`;return new URL(c).hostname}catch{const r=e.trim().replace(/^https?:\/\//,"").split("/"),[c]=r,[o]=c.split(":");return o||""}}function ae(e){return e?/^(\d{1,3}\.){3}\d{1,3}$/.test(e)?e.split(".").every(o=>parseInt(o)>=0&&parseInt(o)<=255):fe.HOSTNAME.test(e):!1}function Fe(e){return fe.PORT.test(String(e))}function He(e){try{return new URL(e),!0}catch{return!1}}const k={STORAGE_KEY:"tak-profiles",TABS:{ATAK:"atak",ITAK:"itak",IMPORT:"import",PROFILES:"profiles",HELP:"help"},PROTOCOLS:{HTTPS:"https",HTTP:"http",SSL:"ssl",TCP:"tcp"},NOTIFICATION_DURATION:3e3,STATUS_DURATION:5e3,DEBOUNCE_DELAY:300,QR_SIZE:256,QR_MARGIN:2,PATTERNS:{HOSTNAME:/^[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,60}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,60}[a-zA-Z0-9])?)*$/,PORT:/^([1-9][0-9]{0,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$/,URL:/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)$/}},M={PROFILE_NAME_REQUIRED:"Profile name is required",PROFILE_EXISTS:"A profile with this name already exists. Do you want to overwrite it?",INVALID_HOSTNAME:"Please enter a valid hostname or IP address",INVALID_PORT:"Please enter a valid port number (1-65535)",INVALID_URL:"Please enter a valid URL",QR_GENERATION_ERROR:"Error generating QR code",DOWNLOAD_ERROR:"Error downloading QR code",CLIPBOARD_ERROR:"Error copying to clipboard",LOAD_PROFILES_ERROR:"Error loading profiles"},q=function(){let e=k.TABS.ATAK,r=e;function c(){document.querySelectorAll(".tab-btn").forEach(i=>{i.addEventListener("click",()=>{const s=i.dataset.tab;o(s)})})}function o(a){const i=document.querySelectorAll(".tab-btn"),s=document.querySelectorAll(".tab-pane");i.forEach(m=>{m.classList.remove("active"),m.setAttribute("aria-selected","false")});const u=document.querySelector(`[data-tab="${a}"]`);u&&(u.classList.add("active"),u.setAttribute("aria-selected","true")),s.forEach(m=>{m.classList.remove("active"),m.setAttribute("aria-hidden","true")});const d=document.getElementById(`${a}-tab`);d&&(d.classList.add("active"),d.setAttribute("aria-hidden","false")),e===k.TABS.ATAK&&a===k.TABS.ITAK?t():e===k.TABS.ITAK&&a===k.TABS.ATAK&&n(),e=a,[k.TABS.ATAK,k.TABS.ITAK,k.TABS.IMPORT].includes(a)&&(r=a)}function t(){const a=document.getElementById("atak-host");if(!a?.value.trim())return;const i=document.getElementById("itak-url");i?.value.trim()||(i.value=`https://${a.value.trim()}`,O.updateiTAKQR(),L.showDataStatus("itak"),L.showNotification("Server URL copied from ATAK tab","info"))}function n(){const a=document.getElementById("itak-url");if(!a?.value.trim())return;const i=X(a.value);if(i){const s=document.getElementById("atak-host");s?.value.trim()||(s.value=i,O.updateATAKQR(),L.showDataStatus("atak"),L.showNotification("Server hostname copied from iTAK tab","info"))}}return{init:c,switchTab:o,getCurrentTab:()=>e,getLastConfigTab:()=>r}}(),O=function(){async function e(i,s){const u=document.getElementById(s);if(!u)return null;if(!i)return u.innerHTML='<div class="qr-placeholder">Enter configuration details above</div>',u.setAttribute("aria-label","QR code will appear here when form is complete"),null;try{const d=await Ke.toCanvas(i,{width:k.QR_SIZE,margin:k.QR_MARGIN,color:{dark:"#000000",light:"#FFFFFF"}}),m=u.querySelector(".qr-placeholder");m&&m.remove();const l=u.querySelector("canvas");return u.setAttribute("aria-label","QR code generated successfully"),d&&typeof d=="object"&&d.nodeType===1&&(d.style.opacity="0",u.appendChild(d),d.offsetHeight,d.style.opacity="1",l&&(l.style.opacity="0",l.addEventListener("transitionend",()=>l.remove(),{once:!0}))),d}catch(d){return console.error(M.QR_GENERATION_ERROR,d),L.showNotification(M.QR_GENERATION_ERROR,"error"),null}}async function r(){const i=document.getElementById("atak-host")?.value||"",s=document.getElementById("atak-username")?.value||"",u=document.getElementById("atak-token")?.value||"";if(i.trim()&&s.trim()&&u.trim()){if(!ae(i.trim())){L.showNotification(M.INVALID_HOSTNAME,"error"),e(null,"atak-qr"),L.disableButtons("atak");return}const d=`tak://com.atakmap.app/enroll?host=${encodeURIComponent(i.trim())}&username=${encodeURIComponent(s.trim())}&token=${encodeURIComponent(u.trim())}`;await e(d,"atak-qr"),L.enableButtons("atak");const m=document.getElementById("atak-qr");m&&(m.dataset.uri=d)}else await e(null,"atak-qr"),L.disableButtons("atak")}const c=Ct(r,k.DEBOUNCE_DELAY);async function o(){const i=document.getElementById("itak-description")?.value||"",s=document.getElementById("itak-url")?.value||"",u=document.getElementById("itak-port")?.value||"",d=document.getElementById("itak-protocol")?.value||"",m=X(s),l=d===k.PROTOCOLS.HTTPS?k.PROTOCOLS.SSL:k.PROTOCOLS.TCP;if([i,m,u].every(h=>h&&h.trim()!=="")){if(!ae(m)){L.showNotification(M.INVALID_HOSTNAME,"error"),e(null,"itak-qr"),L.disableButtons("itak");return}if(!Fe(u)){L.showNotification(M.INVALID_PORT,"error"),e(null,"itak-qr"),L.disableButtons("itak");return}const h=`${i.trim()},${m},${u.trim()},${l}`;await e(h,"itak-qr"),L.enableButtons("itak");const b=document.getElementById("itak-qr");b&&(b.dataset.uri=h)}else await e(null,"itak-qr"),L.disableButtons("itak")}const t=Ct(o,k.DEBOUNCE_DELAY);async function n(){const i=document.getElementById("import-url")?.value||"";if(i.trim()){if(!He(i.trim())){L.showNotification(M.INVALID_URL,"error"),e(null,"import-qr"),L.disableButtons("import");return}const s=`tak://com.atakmap.app/import?url=${encodeURIComponent(i.trim())}`;await e(s,"import-qr"),L.enableButtons("import");const u=document.getElementById("import-qr");u&&(u.dataset.uri=s)}else await e(null,"import-qr"),L.disableButtons("import")}const a=Ct(n,k.DEBOUNCE_DELAY);return{updateATAKQR:c,updateiTAKQR:t,updateImportQR:a,updateATAKQRCore:r,updateiTAKQRCore:o,updateImportQRCore:n}}(),G=function(){let e=[];function r(){c(),document.getElementById("save-profile")?.addEventListener("click",u),document.getElementById("load-profile")?.addEventListener("click",d)}function c(){try{e=JSON.parse(localStorage.getItem(k.STORAGE_KEY)||"[]"),s()}catch(l){console.error(M.LOAD_PROFILES_ERROR,l),e=[]}}function o(){try{localStorage.setItem(k.STORAGE_KEY,JSON.stringify(e))}catch(l){console.error("Error saving profiles:",l),L.showNotification("Error saving profiles","error")}}function t(){const l=q.getCurrentTab(),f=[k.TABS.ATAK,k.TABS.ITAK,k.TABS.IMPORT].includes(l)?l:q.getLastConfigTab(),g={host:document.getElementById("atak-host")?.value||"",username:document.getElementById("atak-username")?.value||"",token:document.getElementById("atak-token")?.value||""},h={description:document.getElementById("itak-description")?.value||"",url:document.getElementById("itak-url")?.value||"",port:document.getElementById("itak-port")?.value||"",protocol:document.getElementById("itak-protocol")?.value||""},b={url:document.getElementById("import-url")?.value||""},A=[];return Object.values(g).some(y=>y)&&A.push(k.TABS.ATAK),Object.values(h).some(y=>y)&&A.push(k.TABS.ITAK),b.url&&A.push(k.TABS.IMPORT),{type:f,timestamp:Date.now(),savedTabs:A,atak:g,itak:h,import:b}}function n(){const l=document.getElementById("profile-name"),f=document.getElementById("profile-description"),g=l?.value.trim()||"",h=f?.value.trim()||"",b=H(g),A=H(h);if(!b){L.showNotification(M.PROFILE_NAME_REQUIRED,"error");return}const y=t();y.name=b,y.description=A;const w=e.findIndex(T=>T.name===b);if(w>=0){if(!confirm(M.PROFILE_EXISTS))return;e[w]=y}else e.push(y);o(),s(),J.closeModal(),L.showNotification("Profile saved successfully!","success")}function a(l){if(!l)return;const f=l.atak||{host:l.host,username:l.username,token:l.token},g=l.itak||{description:l.description,url:l.url,port:l.port,protocol:l.protocol},h=l.import||{url:l.url},b=[];if(f&&(f.host||f.username||f.token)){const y=document.getElementById("atak-host"),w=document.getElementById("atak-username"),T=document.getElementById("atak-token");y&&(y.value=f.host||""),w&&(w.value=f.username||""),T&&(T.value=f.token||""),O.updateATAKQR(),b.push(k.TABS.ATAK)}if(g&&(g.description||g.url||g.port||g.protocol)){const y=document.getElementById("itak-description"),w=document.getElementById("itak-url"),T=document.getElementById("itak-port"),N=document.getElementById("itak-protocol");y&&(y.value=g.description||""),w&&(w.value=g.url||""),T&&(T.value=g.port||"8089"),N&&(N.value=g.protocol||k.PROTOCOLS.HTTPS),O.updateiTAKQR(),b.push(k.TABS.ITAK)}if(h&&h.url){const y=document.getElementById("import-url");y&&(y.value=h.url||""),O.updateImportQR(),b.push(k.TABS.IMPORT)}const A=l.savedTabs?.[0]||l.type||b[0];A&&q.switchTab(A),J.closeModal(),L.showNotification("Profile loaded successfully!","success")}function i(l){confirm(`Are you sure you want to delete the profile "${l}"?`)&&(e=e.filter(f=>f.name!==l),o(),s(),L.showNotification("Profile deleted successfully!","success"))}function s(){const l=document.getElementById("profiles-container");if(l){if(e.length===0){l.innerHTML='<p style="grid-column: 1 / -1; color: var(--text-secondary);">No saved profiles yet. Create your first profile to get started.</p>';return}l.innerHTML=e.map(f=>{const g=JSON.stringify(f).replace(/"/g,"&quot;"),h=f.savedTabs?.length?f.savedTabs.join(", ").toUpperCase():(f.type||"").toUpperCase();return`
        <div class="profile-card">
          <h4>${H(f.name)}</h4>
          <p>${H(f.description||"No description")}</p>
          <p><strong>Tabs:</strong> ${h}</p>
          <p><strong>Created:</strong> ${new Date(f.timestamp).toLocaleDateString()}</p>
          <div class="profile-actions">
            <button class="btn btn-primary" onclick="ProfileManager.loadProfile(${g})">Load</button>
            <button class="btn btn-secondary" onclick="ProfileManager.deleteProfile('${H(f.name)}')">Delete</button>
          </div>
        </div>
      `}).join("")}}function u(){const l=document.getElementById("modal-title"),f=document.getElementById("profile-name"),g=document.getElementById("profile-description");l&&(l.textContent="Save Profile");const h=t();f&&(f.value=h.name||""),g&&(g.value=h.description||""),J.openModal()}function d(){const l=document.getElementById("modal-title");l&&(l.textContent="Load Profile"),m(),J.openModal()}function m(){const l=document.querySelector(".modal-body");if(!l||e.length===0){l&&(l.innerHTML="<p>No profiles available to load.</p>");return}l.innerHTML=`
      <div class="profile-selection">
        <p>Select a profile to load:</p>
        <div class="profile-list" role="list">
          ${e.map(f=>{const g=JSON.stringify(f).replace(/"/g,"&quot;");return`
              <div class="profile-item" role="listitem" tabindex="0"
                   onclick="ProfileManager.loadProfile(${g})"
                   onkeypress="if(event.key === 'Enter') ProfileManager.loadProfile(${g})">
                <h4>${H(f.name)}</h4>
                <p>${H(f.description||"No description")}</p>
                <span class="profile-type">${f.type.toUpperCase()}</span>
              </div>
            `}).join("")}
        </div>
      </div>
    `}return{init:r,saveProfile:n,loadProfile:a,deleteProfile:i}}(),L=function(){function e(a,i="info"){document.querySelectorAll(".notification").forEach(d=>d.remove());const u=document.createElement("div");u.className=`notification notification-${i}`,u.textContent=a,u.setAttribute("role","alert"),u.setAttribute("aria-live","polite"),document.body.appendChild(u),u.offsetHeight,u.classList.add("notification-show"),setTimeout(()=>{u.classList.remove("notification-show"),u.classList.add("notification-hide"),setTimeout(()=>u.remove(),300)},k.NOTIFICATION_DURATION)}function r(a){const i=document.getElementById(`${a}-data-status`);i&&(i.style.display="flex",setTimeout(()=>{i.style.display="none"},k.STATUS_DURATION))}function c(a){const i=document.getElementById(`${a}-download`),s=document.getElementById(`${a}-copy`);i&&(i.disabled=!1),s&&(s.disabled=!1)}function o(a){const i=document.getElementById(`${a}-download`),s=document.getElementById(`${a}-copy`);i&&(i.disabled=!0),s&&(s.disabled=!0)}async function t(a){const s=document.getElementById(`${a}-qr`)?.querySelector("canvas");if(s)try{const u=document.createElement("a");u.download=`tak-${a}-config.png`,u.href=s.toDataURL(),u.click()}catch(u){console.error(M.DOWNLOAD_ERROR,u),e(M.DOWNLOAD_ERROR,"error")}}async function n(a){let i="";switch(a){case k.TABS.ATAK:{const s=document.getElementById("atak-host")?.value||"",u=document.getElementById("atak-username")?.value||"",d=document.getElementById("atak-token")?.value||"";i=`tak://com.atakmap.app/enroll?host=${encodeURIComponent(s.trim())}&username=${encodeURIComponent(u.trim())}&token=${encodeURIComponent(d.trim())}`;break}case k.TABS.ITAK:{const s=document.getElementById("itak-description")?.value||"",u=document.getElementById("itak-url")?.value||"",d=document.getElementById("itak-port")?.value||"",m=document.getElementById("itak-protocol")?.value||"",l=X(u),f=m===k.PROTOCOLS.HTTPS?k.PROTOCOLS.SSL:k.PROTOCOLS.TCP;i=`${s.trim()},${l},${d.trim()},${f}`;break}case k.TABS.IMPORT:{const s=document.getElementById("import-url")?.value||"";i=`tak://com.atakmap.app/import?url=${encodeURIComponent(s.trim())}`;break}}try{await navigator.clipboard.writeText(i),e("URI copied to clipboard!","success")}catch(s){console.error(M.CLIPBOARD_ERROR,s),e(M.CLIPBOARD_ERROR,"error")}}return{showNotification:e,showDataStatus:r,enableButtons:c,disableButtons:o,downloadQR:t,copyURI:n}}(),kt=function(){function e(){r(),c(),o(),t()}function r(){const i=document.getElementById("atak-form");if(!i)return;i.querySelectorAll("input").forEach(u=>{u.setAttribute("aria-required","true"),u.addEventListener("input",()=>O.updateATAKQR())})}function c(){const i=document.getElementById("itak-form");if(!i)return;i.querySelectorAll("input, select").forEach(u=>{u.setAttribute("aria-required","true"),u.addEventListener("input",()=>O.updateiTAKQR())})}function o(){const i=document.getElementById("import-form");if(!i)return;i.querySelectorAll("input").forEach(u=>{u.setAttribute("aria-required","true"),u.addEventListener("input",()=>O.updateImportQR())})}function t(){document.addEventListener("click",i=>{const{target:s}=i;if(s.id?.endsWith("-download")){const u=s.id.replace("-download","");L.downloadQR(u)}if(s.id?.endsWith("-copy")){const u=s.id.replace("-copy","");L.copyURI(u)}})}function n(){const i=document.getElementById("atak-host")?.value||"",s=document.getElementById("atak-username")?.value||"",u=document.getElementById("atak-token")?.value||"";if(i.trim()){let d=i.trim(),m=k.PROTOCOLS.HTTPS;try{if(i.trim().includes("://")){const g=new URL(i.trim()),{hostname:h,protocol:b}=g;d=h,m=b.replace(":","")}}catch{}const l=document.getElementById("itak-url"),f=document.getElementById("itak-protocol");l&&(l.value=`${m}://${d}`),f&&(f.value=m)}if(s.trim()){const d=document.getElementById("itak-username");d&&(d.value=s.trim())}if(u.trim()){const d=document.getElementById("itak-token");d&&(d.value=u.trim())}O.updateiTAKQR()}function a(){const i=document.getElementById("itak-url")?.value||"",s=document.getElementById("itak-username")?.value||"",u=document.getElementById("itak-token")?.value||"";if(i.trim()){const d=X(i);if(d){const m=document.getElementById("atak-host");m&&(m.value=d)}}if(s.trim()){const d=document.getElementById("atak-username");d&&(d.value=s.trim())}if(u.trim()){const d=document.getElementById("atak-token");d&&(d.value=u.trim())}O.updateATAKQR()}return{init:e,populateiTAKFromATAK:n,populateATAKFromiTAK:a}}(),J=function(){let e;function r(){if(e=document.getElementById("profile-modal"),!e)return;const t=e.querySelector(".modal-close"),n=document.getElementById("modal-cancel"),a=document.getElementById("modal-save");t?.addEventListener("click",o),n?.addEventListener("click",o),a?.addEventListener("click",G.saveProfile),e.addEventListener("click",i=>{i.target===e&&o()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&e.classList.contains("active")&&o()})}function c(){e&&(e.classList.add("active"),e.setAttribute("aria-modal","true"),setTimeout(()=>{e.querySelector("input, select, textarea")?.focus()},100))}function o(){e&&(e.classList.remove("active"),e.removeAttribute("aria-modal"))}return{init:r,openModal:c,closeModal:o}}(),$e=function(){function e(){document.getElementById("help-button")?.addEventListener("click",()=>q.switchTab(k.TABS.HELP)),document.addEventListener("keydown",o=>{o.key==="F1"&&(o.preventDefault(),q.switchTab(k.TABS.HELP))}),document.getElementById("back-to-top")?.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}return{init:e}}(),ze=(()=>{const e="tak-theme";function r(){const n=localStorage.getItem(e);return n||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}function c(n){document.documentElement.setAttribute("data-theme",n),localStorage.setItem(e,n);const a=n==="dark"?"#1e293b":"#1e40af";document.querySelector('meta[name="theme-color"]')?.setAttribute("content",a)}function o(){const a=r()==="light"?"dark":"light";c(a)}function t(){const n=r();c(n),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",i=>{localStorage.getItem(e)||c(i.matches?"dark":"light")});const a=document.getElementById("theme-toggle");a&&a.addEventListener("click",o)}return{init:t,toggleTheme:o,getCurrentTheme:r,applyTheme:c}})(),se=(()=>{const e="appVersion",r="3.1.0";async function c(){const o=document.getElementById("app-version"),t=document.getElementById("update-notice");o&&(o.textContent=`v${r}`);const n=localStorage.getItem(e);n&&n!==r&&L.showNotification(`Updated to version ${r}`,"success"),localStorage.setItem(e,r);try{const i=await(await fetch("version.json",{cache:"no-store"})).json();t&&(t.style.display=i.version!==r?"inline":"none")}catch{}}return{init:c}})();async function Qe(){ze.init(),q.init(),kt.init(),G.init(),J.init(),$e.init(),se.init(),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",()=>{se.init()})}document.addEventListener("DOMContentLoaded",Qe);window.updateATAKQR=O.updateATAKQRCore;window.updateiTAKQR=O.updateiTAKQRCore;window.updateImportQR=O.updateImportQRCore;window.populateiTAKFromATAK=kt.populateiTAKFromATAK;window.populateATAKFromiTAK=kt.populateATAKFromiTAK;window.transferDataFromATAKToiTAK=()=>q.switchTab(k.TABS.ITAK);window.transferDataFromiTAKToATAK=()=>q.switchTab(k.TABS.ATAK);window.showNotification=L.showNotification;window.loadProfile=G.loadProfile;window.deleteProfile=G.deleteProfile;window.ProfileManager=G;window.showDataStatus=L.showDataStatus;window.switchTab=q.switchTab;
